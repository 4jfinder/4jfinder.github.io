<!DOCTYPE html>
<html lang="en">
  <head>
    <title>CISA Log4j (CVE-2021-44228) Affected Vendor & Software List</title>

    <!-- Bootstrap CSS -->
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css"
      rel="stylesheet"
      integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3"
      crossorigin="anonymous"
    />

    <!-- Cosmo Bootstrap theme -->
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/bootswatch@5.1.3/dist/cosmo/bootstrap.min.css"
      crossorigin="anonymous"
    />

    <!-- jQuery dataTables plugin CSS -->
    <link rel="stylesheet" type="text/css" href="cisalist.css" />

    <!-- jQuery Javascript -->
    <script
      src="https://code.jquery.com/jquery-3.6.0.min.js"
      integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4="
      crossorigin="anonymous"
    ></script>

    <!-- jQuery dataTables Javascript -->
    <link
      rel="stylesheet"
      type="text/css"
      href="https://cdn.datatables.net/v/dt/dt-1.11.4/datatables.min.css"
    />
    <script
      type="text/javascript"
      src="https://cdn.datatables.net/v/dt/dt-1.11.4/datatables.min.js"
    ></script>

    <!-- YAML Parser -->
    <script
      type="text/javascript"
      charset="utf8"
      src="./js_yaml.js"
      crossorigin="anonymous"
    ></script>

    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script
      async
      src="https://www.googletagmanager.com/gtag/js?id=G-VKXYK1YV21"
    ></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag() {
        dataLayer.push(arguments);
      }
      gtag("js", new Date());
      gtag("config", "G-VKXYK1YV21");
    </script>

    <script>
      function renderLinks(links) {
        let retval = "";
        for (link of links) {
          if (/^https?:/.exec(link)) {
            retval += '<a href="' + encodeURI(link) + '">link</a>';
          }
        }
        return retval;
      }

      function cveStatus(cves) {
        const cve_44228 = cves["cve-2021-44228"];
        if (cve_44228.investigated) {
          if (!!cve_44228.fixed_versions.length) {
            return "Affected: Mitigated";
          } else if (!!cve_44228.affected_versions.length) {
            return "Affected: Unmitigated";
          }
          return "Not Affected";
        }
        return "Unknown";
      }

      function renderStatus(cves, type, row) {
        const link = String(row.vendor_links[0]);
        const status = cveStatus(cves);

        if (/^https?:/.exec(link)) {
          return '<a href="' + encodeURI(link) + '">' + status + "</a>";
        }
        return status;
      }

      $(document).ready(function () {
        fetch(
          "https://github.com/cisagov/log4j-affected-db/blob/develop/data/cisagov.yml"
        )
          .then((response) => {
            return response.text();
          })
          .then((data) => {
            const yaml_data = jsYaml.load(data);

            document.querySelector("#cisalist").innerHTML =
              '<table class="display"></table>';
            $("#cisalist > table.display").DataTable({
              data: yaml_data.software,
              paging: true,
              stateSave: true,
              searching: true,
              columns: [
                {
                  data: "vendor",
                  title: "Vendor",
                },
                {
                  data: "product",
                  title: "Product",
                },
                {
                  data: "cves",
                  title: "Status CVE-2021-44228",
                  searchable: false,
                  render: renderStatus,
                  width: "12em",
                },
                {
                  data: "notes",
                  title: "Notes",
                  searchable: false,
                },
                {
                  data: "last_updated",
                  title: "Last Updated",
                  searchable: false,
                  defaultContent: "",
                  render: (data) => String(data).replace(/T.*$/, ""),
                },
              ],
            });
          });
      });
    </script>
  </head>

  <body>
    <div class="container">
      <div id="main">
        <div class="row">
          <div class="col-12">
            <h1 id="cisalog4jcve202144228affectedvendorsoftwarelist">
              CISA Log4j (CVE-2021-44228) Affected Vendor &amp; Software List
            </h1>
            <h2 id="statusdescriptions">Status Descriptions</h2>
            <table>
              <thead>
                <tr>
                  <th width="100">Status</th>
                  <th>Description</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td>Unknown</td>
                  <td>Status unknown. Default choice.</td>
                </tr>
                <tr>
                  <td>Affected</td>
                  <td>Reported to be affected by CVE-2021-44228.</td>
                </tr>
                <tr>
                  <td>Not Affected</td>
                  <td>
                    Reported to NOT be affected by CVE-2021-44228 and no further
                    action necessary.
                  </td>
                </tr>
              </tbody>
            </table>
            <h2 id="softwarelist">Software List</h2>
            <p>
              This list has been populated using information from the following
              sources:
            </p>
            <ul>
              <li>Kevin Beaumont</li>
              <li>SwitHak</li>
              <li>National Cyber Security Centre - Netherlands (NCSC-NL)</li>
            </ul>
            <p>
              NOTE: This file is automatically generated. To submit updates,
              please refer to
              <a href="CONTRIBUTING.md"><code>CONTRIBUTING.md</code></a
              >.
            </p>
            <!-- Loading screen for slow load times -->
            <div class="col-12" id="cisalist">
              <div class="loader">
                <div class="duo duo1">
                  <div class="dot dot-a"></div>
                  <div class="dot dot-b"></div>
                </div>
                <div class="duo duo2">
                  <div class="dot dot-a"></div>
                  <div class="dot dot-b"></div>
                </div>
              </div>
              <div class="col-md-6 mx-auto p-5 text-center">
                <div class="display-4">Loading data...</div>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Footer -->
      <div class="col-md-8 mx-auto mt-4 p-2">
        <p>
          Data loaded from the
          <a href="https://github.com/cisagov/log4j-affected-db"
            >CISA Log4j (CVE-2021-44228) Affected Vendor & Software List</a
          >
          GitHub repository, maintained by the
          <a href="https://www.cisa.gov/"
            >US Cybersecurity and Infrastructure Security Agency (CISA)</a
          >.
        </p>
        <p>
          Searchable index by <a href="https://beauwoods.com">Beau Woods</a> and
          <a href="https://mobile.twitter.com/arcon">Adam Bregenzer</a>,
          licensed CC0 and in the public domain<a
            rel="license"
            href="http://creativecommons.org/publicdomain/zero/1.0/"
          >
            <img
              src="https://licensebuttons.net/p/zero/1.0/80x15.png"
              style="border-style: none"
              alt="CC0" /></a
          >. Find the code on
          <a href="https://github.com/beauwoods/cisa-log4j-searchable">GitHub</a
          >.
        </p>
      </div>
    </div>

    <!-- Popper and Bootstrap Javascript -->
    <script
      src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.10.2/dist/umd/popper.min.js"
      integrity="sha384-7+zCNj/IqJ95wo16oMtfsKbZ9ccEh31eOz1HGyDuCQ6wgnyJNSYdrPa03rtR1zdB"
      crossorigin="anonymous"
    ></script>
    <script
      src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.min.js"
      integrity="sha384-QJHtvGhmr9XOIpI6YVutG+2QOK9T+ZnN4kzFN1RtK3zEFEIsxhlmWl5/YESvpZ13"
      crossorigin="anonymous"
    ></script>
  </body>
</html>
